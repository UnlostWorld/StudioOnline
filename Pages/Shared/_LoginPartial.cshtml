@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Identity
@using StudioOnline.Identity
@using System.Collections

@inject SignInManager<ApplicationUser> SignInManager
@inject UserManager<ApplicationUser> UserManager

@if (SignInManager.IsSignedIn(User))
{
	var disconnectHandler = new HttpAction("api/Identity/Disconnect");

	<Button Click="@disconnectHandler">
		<TextBlock Text="@User.Identity?.Name" />
	</Button>
}
else
{
	IEnumerable<AuthenticationScheme> schemes = await SignInManager.GetExternalAuthenticationSchemesAsync();
	foreach (AuthenticationScheme authScheme in schemes)
	{
		var connectHandler = new HttpAction("api/Identity/Connect", HttpMethods.Post, "provider", authScheme.Name);
		<Button Click="@connectHandler">
			<TextBlock Text="@authScheme.DisplayName" />
		</Button>
	}
}
